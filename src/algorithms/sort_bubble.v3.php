<?php
/**
 * Bubble Sort v3
 *
 * Even more optimization as proposed by Algorithmist where which each pass, the 
 * inner loop count can be decremented since each pass moves the highest value to 
 * the end of the stack
 */ 

function bubbleSort($array)
{
    $time_start = microtime(true);

    if( !is_array($array) ) {
        return false;
    }

    $count = sizeof($array);

    for( $i=0; $i<$count-2; $i++ ) {
        $swaps = 0;
        for( $j=0; $j<$count-1-$i; $j++ ) { //note how $count - 1 - $i
            if( $array[$j] > $array[$j+1] ) {
                $left = $array[$j];

                $array[$j] = $array[$j+1];
                $array[$j+1] = $left;

                $swaps++;
            }
        }
        if( $swaps == 0 ) {
            break;
        }
    }

    $time_end = microtime(true);
    $time = $time_end - $time_start;

    print 'v3 Time: ' . $time . PHP_EOL;

    return $array;
}

$input = str_split('838346001647836430379360675769902010508712039856017490823467940174510362908234679401745103629082346794017451036290823467940174510362908234679401745103629082346794017451036290823467940174510362908234679401745103629082346794017451036297013748659018383460016478364303793606757699020105087120398560174908234679401745103629082346794017451036290823467940174510362908234679401745103629082346794017451036290823467940174510362908234679401745103629082346794017451036290823467940174510362970137486590183834600164783643037936067576990201050871203985601749082346794017451036290823467940174510362908234679401745103629082346794017451036290823467940174510362908234679401745103629082346794017451036290823467940174510362908234679401745103629701374865901838346001647836430379360675769902010508712039856017490823467940174510362908234679401745103629082346794017451036290823467940174510362908234679401745103629082346794017451036290823467940174510362908234679401745103629082346794017451036297013748659018383460016478364303793606757699020105087120398560174908234679401745103629082346794017451036290823467940174510362908234679401745103629082346794017451036290823467940174510362908234679401745103629082346794017451036290823467940174510362970137486590183834600164783643037936067576990201050871203985601749082346794017451036290823467940174510362908234679401745103629082346794017451036290823467940174510362908234679401745103629082346794017451036290823467940174510362908234679401745103629701374865901222222838346001647836430379360675769902010508712039856017490823467940174510362908234679401745103629082346794017451036290823467940174510362908234679401745103629082346794017451036290823467940174510362908234679401745103629082346794017451036297013748659012');
bubbleSort($input);
