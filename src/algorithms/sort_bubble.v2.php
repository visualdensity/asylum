<?php
/**
 * Bubble Sort v2
 *
 * Keep track of swapped elements as optimization. Refer to the following 
 * pseudo code:
 *
 * func bubblesort2( var a as array )
 *     for i from 2 to N
 *         swaps = 0
 *         for j from 0 to N - 2
 *            if a[j] > a[j + 1]
 *               swap( a[j], a[j + 1] )
 *               swaps = swaps + 1
 *         if swaps = 0
 *             break
 * end func
 *
 * Reference:
 * http://www.algorithmist.com/index.php/Bubble_sort#Optimizations
 */

function bubbleSort($array)
{
    if( !is_array($array) ) {
        return false;
    }

    $time_start = microtime(true);
    $count = sizeof($array);

    for($i=0; $i<$count-1; $i++) {
        $swaps = 0;
        for($j=0; $j<$count-1; $j++) {
            if( $array[$j] > $array[$j+1] ) {
                $left = $array[$j];
                $array[$j] = $array[$j+1];
                $array[$j+1] = $left;

                $swaps++;
            }
        }

        if($swaps == 0) {
            break;
        }
    }

    $time_end = microtime(true);
    $time = $time_end - $time_start;

    print 'Bubble v2: ' . $time . PHP_EOL;

    return $array;
}

$input = str_split('838346001647836430379360675769902010508712039856017490823467940174510362908234679401745103629082346794017451036290823467940174510362908234679401745103629082346794017451036290823467940174510362908234679401745103629082346794017451036297013748659018383460016478364303793606757699020105087120398560174908234679401745103629082346794017451036290823467940174510362908234679401745103629082346794017451036290823467940174510362908234679401745103629082346794017451036290823467940174510362970137486590183834600164783643037936067576990201050871203985601749082346794017451036290823467940174510362908234679401745103629082346794017451036290823467940174510362908234679401745103629082346794017451036290823467940174510362908234679401745103629701374865901838346001647836430379360675769902010508712039856017490823467940174510362908234679401745103629082346794017451036290823467940174510362908234679401745103629082346794017451036290823467940174510362908234679401745103629082346794017451036297013748659018383460016478364303793606757699020105087120398560174908234679401745103629082346794017451036290823467940174510362908234679401745103629082346794017451036290823467940174510362908234679401745103629082346794017451036290823467940174510362970137486590183834600164783643037936067576990201050871203985601749082346794017451036290823467940174510362908234679401745103629082346794017451036290823467940174510362908234679401745103629082346794017451036290823467940174510362908234679401745103629701374865901222222838346001647836430379360675769902010508712039856017490823467940174510362908234679401745103629082346794017451036290823467940174510362908234679401745103629082346794017451036290823467940174510362908234679401745103629082346794017451036297013748659012');
bubbleSort($input);
